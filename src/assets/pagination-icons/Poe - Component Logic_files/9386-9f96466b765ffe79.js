(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[9386],{18773:function(e,t,a){"use strict";a.r(t);let n={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"LoginStatusContextWrapper_viewer",selections:[{alias:null,args:null,concreteType:"PoeUser",kind:"LinkedField",name:"poeUser",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null}],storageKey:null}],type:"Viewer",abstractKey:null};n.hash="e90b07f525a729d379d67d8d23638ddb",t.default=n},37480:function(e,t,a){"use strict";var n,l;a.r(t);let i={fragment:{argumentDefinitions:n=[{defaultValue:null,kind:"LocalArgument",name:"chatCode"},{defaultValue:null,kind:"LocalArgument",name:"shouldReturnChatCodePostSignupLogin"}],kind:"Fragment",metadata:null,name:"SignupWallModalContextWrapper_saveLoggedOutImportChatInfo_Mutation",selections:l=[{alias:null,args:[{kind:"Variable",name:"chatCode",variableName:"chatCode"},{kind:"Variable",name:"shouldReturnChatCodePostSignupLogin",variableName:"shouldReturnChatCodePostSignupLogin"}],concreteType:"SaveLoggedOutImportChatInfo",kind:"LinkedField",name:"saveLoggedOutImportChatInfo",plural:!1,selections:[{alias:null,args:null,concreteType:"Viewer",kind:"LinkedField",name:"viewer",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null}],storageKey:null}],storageKey:null}],type:"MutationRoot",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"SignupWallModalContextWrapper_saveLoggedOutImportChatInfo_Mutation",selections:l},params:{id:"be05ee39b9285fff3fe84c22580180c10e74dee606a1298719a2df7a2c76f9ba",metadata:{},name:"SignupWallModalContextWrapper_saveLoggedOutImportChatInfo_Mutation",operationKind:"mutation",text:null}};i.hash="a9352f08c4b11ae465a989c980db65a5",t.default=i},72930:function(e,t,a){"use strict";a.r(t);let n={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"SignupWallModalContextWrapper_viewer",selections:[{alias:null,args:null,kind:"ScalarField",name:"uid",storageKey:null}],type:"Viewer",abstractKey:null};n.hash="e8beb913adc30551104fc70707d899ce",t.default=n},42838:function(e,t,a){"use strict";a.r(t);let n={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"botHelpers_useDeletion_bot",selections:[{alias:null,args:null,kind:"ScalarField",name:"deletionState",storageKey:null}],type:"Bot",abstractKey:null};n.hash="9055843994f978f06f4287ddd47770eb",t.default=n},82071:function(e,t,a){"use strict";a.r(t);let n={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"botHelpers_useIsSDXL_bot",selections:[{alias:null,args:null,kind:"ScalarField",name:"baseBotId",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"botId",storageKey:null}],type:"Bot",abstractKey:null};n.hash="18a7b2a14544f2ec7958beb7b31af2e1",t.default=n},34905:function(e,t,a){"use strict";a.r(t);let n={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"botHelpers_useViewerCanAccessPrivateBot",selections:[{alias:null,args:null,kind:"ScalarField",name:"canUserAccessBot",storageKey:null}],type:"Bot",abstractKey:null};n.hash="a546c361bedaf1bbab944d85f0092d95",t.default=n},38764:function(e,t,a){"use strict";a.r(t);let n={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"botHelpers_useViewerHasNoMessagesLeft_bot",selections:[{alias:null,args:null,concreteType:"MessageLimit",kind:"LinkedField",name:"messageUsageLimit",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"canSendMessage",storageKey:null}],storageKey:null}],type:"Bot",abstractKey:null};n.hash="b534540ecb9018fabe71762576141b39",t.default=n},45981:function(e,t,a){"use strict";a.r(t);let n={kind:"InlineDataFragment",name:"chatHelpers_isBotMessage"};n.hash="64b43a660c617c778ba7c985fb940384",t.default=n},33740:function(e,t,a){"use strict";a.r(t);let n={kind:"InlineDataFragment",name:"chatHelpers_isChatBreak"};n.hash="1a0d732e0f7f02a776909413142e4052",t.default=n},71349:function(e,t,a){"use strict";a.r(t);let n={kind:"InlineDataFragment",name:"chatHelpers_isHumanMessage"};n.hash="8e00e818ac5576af67c698210e1bce47",t.default=n},30561:function(e,t,a){"use strict";var n,l;a.r(t);let i={fragment:{argumentDefinitions:n=[{defaultValue:null,kind:"LocalArgument",name:"messageId"},{defaultValue:null,kind:"LocalArgument",name:"textLength"}],kind:"Fragment",metadata:null,name:"chatHelpers_messageCancel_Mutation",selections:l=[{alias:null,args:[{kind:"Variable",name:"messageId",variableName:"messageId"},{kind:"Variable",name:"textLength",variableName:"textLength"}],concreteType:"MessageCancel",kind:"LinkedField",name:"messageCancel",plural:!1,selections:[{alias:null,args:null,concreteType:"Message",kind:"LinkedField",name:"message",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"state",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"text",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"textLengthOnCancellation",storageKey:null}],storageKey:null}],storageKey:null}],type:"MutationRoot",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"chatHelpers_messageCancel_Mutation",selections:l},params:{id:"33ae28dd801cbaeb3e988a9db5097b065329af60b99f6de710ffd1fae5ce995e",metadata:{},name:"chatHelpers_messageCancel_Mutation",operationKind:"mutation",text:null}};i.hash="2f821e79b0cce4e82461610e409cebf9",t.default=i},11701:function(e,t,a){"use strict";var n,l,i,r,s,o,u,d,c,g,m,f,p,h,k,y,b,v,S,_,C,L,F,M,w,B,x;a.r(t);let E=(_={alias:null,args:null,kind:"ScalarField",name:"clientNonce",storageKey:null},C={alias:null,args:null,kind:"ScalarField",name:"contentType",storageKey:null},L={alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},F={alias:null,args:null,kind:"ScalarField",name:"size",storageKey:null},M={alias:null,args:null,kind:"ScalarField",name:"mimeType",storageKey:null},w={alias:null,args:null,kind:"ScalarField",name:"status",storageKey:null},B={alias:null,args:null,kind:"ScalarField",name:"statusMessage",storageKey:null},x={alias:null,args:null,concreteType:"MessageCreateFailedUrl",kind:"LinkedField",name:"failedUrls",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"url",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"reason",storageKey:null}],storageKey:null},{fragment:{argumentDefinitions:[n={defaultValue:null,kind:"LocalArgument",name:"attachments"},l={defaultValue:null,kind:"LocalArgument",name:"bot"},i={defaultValue:null,kind:"LocalArgument",name:"chatId"},r={defaultValue:null,kind:"LocalArgument",name:"clientNonce"},s={defaultValue:null,kind:"LocalArgument",name:"query"},o={defaultValue:null,kind:"LocalArgument",name:"sdid"},u={defaultValue:null,kind:"LocalArgument",name:"source"},d={defaultValue:null,kind:"LocalArgument",name:"withChatBreak"}],kind:"Fragment",metadata:null,name:"chatHelpers_sendMessageMutation_Mutation",selections:[{alias:null,args:c=[{kind:"Variable",name:"attachments",variableName:"attachments"},{kind:"Variable",name:"bot",variableName:"bot"},{kind:"Variable",name:"chatId",variableName:"chatId"},{kind:"Variable",name:"clientNonce",variableName:"clientNonce"},{kind:"Variable",name:"query",variableName:"query"},{kind:"Variable",name:"sdid",variableName:"sdid"},{kind:"Variable",name:"source",variableName:"source"},{kind:"Variable",name:"withChatBreak",variableName:"withChatBreak"}],concreteType:"MessageEdgeCreate",kind:"LinkedField",name:"messageEdgeCreate",plural:!1,selections:[{alias:null,args:null,concreteType:"MessageEdge",kind:"LinkedField",name:"chatBreak",plural:!1,selections:[g={alias:null,args:null,kind:"ScalarField",name:"cursor",storageKey:null},S={alias:null,args:null,concreteType:"Message",kind:"LinkedField",name:"node",plural:!1,selections:[m={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},f={alias:null,args:null,kind:"ScalarField",name:"messageId",storageKey:null},p={alias:null,args:null,kind:"ScalarField",name:"text",storageKey:null},h={alias:null,args:null,kind:"ScalarField",name:"author",storageKey:null},k={alias:null,args:null,kind:"ScalarField",name:"suggestedReplies",storageKey:null},y={alias:null,args:null,kind:"ScalarField",name:"creationTime",storageKey:null},b={alias:null,args:null,kind:"ScalarField",name:"state",storageKey:null},v={kind:"ClientExtension",selections:[{alias:null,args:null,kind:"ScalarField",name:"isOptimistic",storageKey:null}]}],storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"MessageEdge",kind:"LinkedField",name:"message",plural:!1,selections:[g,{alias:null,args:null,concreteType:"Message",kind:"LinkedField",name:"node",plural:!1,selections:[m,f,p,h,k,y,b,_,C,{alias:null,args:null,concreteType:"MessageAttachment",kind:"LinkedField",name:"attachments",plural:!0,selections:[L,{alias:null,args:null,concreteType:"File",kind:"LinkedField",name:"file",plural:!1,selections:[F,M],storageKey:null}],storageKey:null},v],storageKey:null}],storageKey:null},w,B,x],storageKey:null}],type:"MutationRoot",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[i,l,s,u,d,r,o,n],kind:"Operation",name:"chatHelpers_sendMessageMutation_Mutation",selections:[{alias:null,args:c,concreteType:"MessageEdgeCreate",kind:"LinkedField",name:"messageEdgeCreate",plural:!1,selections:[{alias:null,args:null,concreteType:"MessageEdge",kind:"LinkedField",name:"chatBreak",plural:!1,selections:[g,S,m],storageKey:null},{alias:null,args:null,concreteType:"MessageEdge",kind:"LinkedField",name:"message",plural:!1,selections:[g,{alias:null,args:null,concreteType:"Message",kind:"LinkedField",name:"node",plural:!1,selections:[m,f,p,h,k,y,b,_,C,{alias:null,args:null,concreteType:"MessageAttachment",kind:"LinkedField",name:"attachments",plural:!0,selections:[L,{alias:null,args:null,concreteType:"File",kind:"LinkedField",name:"file",plural:!1,selections:[F,M,m],storageKey:null},m],storageKey:null},v],storageKey:null},m],storageKey:null},w,B,x],storageKey:null}]},params:{id:"423f47cbc3c55eaeaa17b78c005e72cefc3dcf2bf1b107c4809828155046ab15",metadata:{},name:"chatHelpers_sendMessageMutation_Mutation",operationKind:"mutation",text:null}});E.hash="0e30a030c506a5964418240dee6f0454",t.default=E},79390:function(e,t,a){"use strict";a.r(t);let n={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"chatHelpers_useSendMessage_bot",selections:[{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"nickname",storageKey:null}],type:"Bot",abstractKey:null};n.hash="e918c7e4af1f5307b273a4269f03c1df",t.default=n},36462:function(e,t,a){"use strict";a.r(t);let n={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"chatHelpers_useSendMessage_chat",selections:[{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"chatId",storageKey:null}],type:"Chat",abstractKey:null};n.hash="5536b14fce675b91bf26f17487d99fca",t.default=n},93107:function(e,t,a){"use strict";var n,l,i,r,s,o,u,d,c,g,m;a.r(t);let f=(n=[{defaultValue:null,kind:"LocalArgument",name:"connections"},{defaultValue:null,kind:"LocalArgument",name:"messageId"},{defaultValue:null,kind:"LocalArgument",name:"textLength"}],l=[{kind:"Variable",name:"messageId",variableName:"messageId"},{kind:"Variable",name:"textLength",variableName:"textLength"}],o={alias:null,args:null,concreteType:"Message",kind:"LinkedField",name:"message",plural:!1,selections:[i={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},r={alias:null,args:null,kind:"ScalarField",name:"state",storageKey:null},s={alias:null,args:null,kind:"ScalarField",name:"text",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"textLengthOnCancellation",storageKey:null}],storageKey:null},c=[u={alias:null,args:null,kind:"ScalarField",name:"cursor",storageKey:null},d={alias:null,args:null,concreteType:"Message",kind:"LinkedField",name:"node",plural:!1,selections:[i,{alias:null,args:null,kind:"ScalarField",name:"messageId",storageKey:null},s,{alias:null,args:null,kind:"ScalarField",name:"author",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"suggestedReplies",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"creationTime",storageKey:null},r],storageKey:null}],m=[{kind:"Variable",name:"connections",variableName:"connections"}],{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"chatHelpers_useStopMessageAndSendChatBreak_Mutation",selections:[{alias:null,args:l,concreteType:"MessageCancelAndBreakEdgeCreate",kind:"LinkedField",name:"messageCancelAndBreakEdgeCreate",plural:!1,selections:[o,{alias:null,args:null,concreteType:"MessageEdge",kind:"LinkedField",name:"messageBreakEdge",plural:!1,selections:c,storageKey:null},{alias:null,args:null,concreteType:"MessageEdge",kind:"LinkedField",name:"introductionMessageEdge",plural:!1,selections:c,storageKey:null}],storageKey:null}],type:"MutationRoot",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"chatHelpers_useStopMessageAndSendChatBreak_Mutation",selections:[{alias:null,args:l,concreteType:"MessageCancelAndBreakEdgeCreate",kind:"LinkedField",name:"messageCancelAndBreakEdgeCreate",plural:!1,selections:[o,{alias:null,args:null,concreteType:"MessageEdge",kind:"LinkedField",name:"messageBreakEdge",plural:!1,selections:g=[u,d,i],storageKey:null},{alias:null,args:null,filters:null,handle:"appendEdge",key:"",kind:"LinkedHandle",name:"messageBreakEdge",handleArgs:m},{alias:null,args:null,concreteType:"MessageEdge",kind:"LinkedField",name:"introductionMessageEdge",plural:!1,selections:g,storageKey:null},{alias:null,args:null,filters:null,handle:"appendEdge",key:"",kind:"LinkedHandle",name:"introductionMessageEdge",handleArgs:m}],storageKey:null}]},params:{id:"98865ec11170352a5dc89f056868e26d870ae1aeb586f5c785b3b435f5e6a05e",metadata:{},name:"chatHelpers_useStopMessageAndSendChatBreak_Mutation",operationKind:"mutation",text:null}});f.hash="b9723f63aaf09e124b36110a3a1b1af3",t.default=f},37584:function(e,t,a){"use strict";a.r(t);let n={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"chatHelpers_useStopMessageAndSendChatBreak_bot",selections:[{alias:null,args:null,kind:"ScalarField",name:"introduction",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"model",storageKey:null}],type:"Bot",abstractKey:null};n.hash="61b8765367e446c04af0a76f8d0c4026",t.default=n},38730:function(e,t,a){"use strict";a.r(t);let n={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"chatHelpers_useStopMessageAndSendChatBreak_chat",selections:[{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"chatId",storageKey:null}],type:"Chat",abstractKey:null};n.hash="1c3cd02fad32bc3d8bbf37f07f5190b2",t.default=n},65964:function(e,t,a){"use strict";a.r(t);let n={argumentDefinitions:[],kind:"Fragment",metadata:{plural:!0},name:"chatHelpers_useStopMessageAndSendChatBreak_messageEdges",selections:[{args:null,kind:"FragmentSpread",name:"chatHelpers_useStopMessageUpdater_messageEdges"}],type:"MessageEdge",abstractKey:null};n.hash="4a250899291facf858ada9cabddeccd0",t.default=n},87410:function(e,t,a){"use strict";a.r(t);let n={argumentDefinitions:[],kind:"Fragment",metadata:{plural:!0},name:"chatHelpers_useStopMessageUpdater_messageEdges",selections:[{alias:null,args:null,concreteType:"Message",kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"messageId",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"state",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"text",storageKey:null},{args:null,kind:"FragmentSpread",name:"useIsMessageCancelled_message"}],storageKey:null}],type:"MessageEdge",abstractKey:null};n.hash="c6fdb046e0f346262cf552d0c245a7fe",t.default=n},90138:function(e,t,a){"use strict";a.r(t);let n={argumentDefinitions:[],kind:"Fragment",metadata:{plural:!0},name:"chatHelpers_useStopMessage_messageEdges",selections:[{args:null,kind:"FragmentSpread",name:"chatHelpers_useStopMessageUpdater_messageEdges"}],type:"MessageEdge",abstractKey:null};n.hash="39d15e5667ccfa8c09c3cec226604cda",t.default=n},41360:function(e,t,a){"use strict";a.r(t);let n={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"chatHelpers_useTimeoutLevel",selections:[{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"state",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"text",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"messageId",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"author",storageKey:null},{kind:"ClientExtension",selections:[{alias:null,args:null,kind:"ScalarField",name:"isOptimistic",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"timeoutLevel",storageKey:null}]}],type:"Message",abstractKey:null};n.hash="81bf0e2e8cac1eedb8a2fbe0ea6a7c89",t.default=n},445:function(e,t,a){"use strict";a.r(t);let n={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"chatHelpers_useTimeoutLevel_bot",selections:[{alias:null,args:null,kind:"ScalarField",name:"botId",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"messageTimeoutSecs",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"nickname",storageKey:null}],type:"Bot",abstractKey:null};n.hash="0e3998dad6809039f311bb00a313a2be",t.default=n},8875:function(e,t,a){"use strict";a.r(t);let n={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"chatHelpers_useTimeoutLevel_chat",selections:[{alias:null,args:null,kind:"ScalarField",name:"chatId",storageKey:null}],type:"Chat",abstractKey:null};n.hash="beddec5fd7d466a73b2f09683ce01fd1",t.default=n},38324:function(e,t,a){"use strict";a.r(t);let n={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"chatHelpers_useTimeoutLevel_pairedMessage",selections:[{alias:null,args:null,kind:"ScalarField",name:"messageId",storageKey:null}],type:"Message",abstractKey:null};n.hash="0cbc94329d5ba05bfa355cdc07ecd5fb",t.default=n},85477:function(e,t,a){"use strict";a.r(t);let n={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"chatHelpers_useTimeoutLevel_viewer",selections:[{alias:null,args:null,kind:"ScalarField",name:"uid",storageKey:null}],type:"Viewer",abstractKey:null};n.hash="cc43a92f8fa193d702af8ef1d27252be",t.default=n},48842:function(e,t,a){"use strict";function cloudflareLoader(e){let{src:t}=e;return t}a.r(t),a.d(t,{default:function(){return cloudflareLoader}})},67894:function(e,t,a){"use strict";var n=a(11163),l=a(50530);t.Z=()=>{let{query:e}=(0,n.useRouter)(),t=e.chat;return(0,l.HD)(t)?t:null}},16990:function(e,t,a){"use strict";a.d(t,{Mh:function(){return SidebarStateProvider},PI:function(){return l},Qp:function(){return useSidebarState}});var n,l,i=a(85893),r=a(67294);(n=l||(l={}))[n.DEFAULT=0]="DEFAULT",n[n.OPEN=1]="OPEN",n[n.CLOSED=2]="CLOSED";let s=(0,r.createContext)({setLeftSidebar:()=>{},setRightSidebar:()=>{},setAllSidebars:()=>{}}),useSidebarState=()=>(0,r.useContext)(s),SidebarStateProvider=e=>{let{children:t,setOverallState:a}=e,n=(0,r.useMemo)(()=>({setLeftSidebar:e=>a(t=>{let a=e(t.left),n=1===a&&1===t.right?0:t.right;return a===t.left&&n===t.right?t:{left:a,right:n}}),setRightSidebar:e=>a(t=>{let a=e(t.left),n=1===a&&1===t.left?0:t.left;return n===t.left&&a===t.right?t:{left:n,right:a}}),setAllSidebars:e=>a(t=>{let a=e(t.left),n=e(t.right);return 1===a&&1===n&&(n=0),a===t.left&&n===t.right?t:{left:a,right:n}})}),[a]);return(0,i.jsx)(s.Provider,{value:n,children:t})}},18093:function(e,t,a){"use strict";a.d(t,{v:function(){return useLoggedOutTimeoutContext}});var n=a(85893),l=a(67294),i=a(2012),r=a(35409),s=a(41019);let importLoggedOutUserExpiredModal=()=>a.e(5239).then(a.bind(a,65239)),useLoggedOutTimeoutContext=()=>{let{resetLoggedOutTimeout:e}=l.useContext(o);return{resetLoggedOutTimeout:e}},o=l.createContext({resetLoggedOutTimeout:()=>{}});t.Z=e=>{let{children:t}=e,{isLoggedInUser:a}=(0,i.b)(),[u,d]=(0,l.useState)(!1),[c,g]=(0,l.useState)([]),[m,f]=(0,l.useState)(0),{closeSignupWall:p}=(0,r.zl)();(0,l.useEffect)(()=>{if(!a&&!c.length){let e=window.setTimeout(()=>{d(!0),p(!1)},864e5);c.push(e),g(c)}},[m]);let h=(0,l.useCallback)(()=>{c.length&&c.forEach(e=>window.clearTimeout(e)),g([]),f(m+1)},[c,g,f,m]),k=(0,l.useMemo)(()=>({}),[]),y=(0,l.useMemo)(()=>()=>{},[]),b=(0,l.useMemo)(()=>({resetLoggedOutTimeout:h}),[h]);return(0,n.jsxs)(o.Provider,{value:b,children:[u&&(0,n.jsx)(s.Z,{isOpen:u,onRequestClose:y,body:importLoggedOutUserExpiredModal,bodyProps:k,showCloseButton:!1}),t]})}},2012:function(e,t,a){"use strict";a.d(t,{b:function(){return useLoginStatusContext}});var n=a(85893),l=a(67294),i=a(22578);let useLoginStatusContext=()=>{let{isLoggedInUser:e}=l.useContext(r);return{isLoggedInUser:e}},r=l.createContext({isLoggedInUser:!1});t.Z=e=>{let{viewer:t,children:s}=e,o=(0,i.useFragment)(a(18773),t),u=!!o.poeUser,d=(0,l.useMemo)(()=>({isLoggedInUser:u}),[u]);return(0,n.jsx)(r.Provider,{value:d,children:s})}},35409:function(e,t,a){"use strict";a.d(t,{dh:function(){return l},zl:function(){return useSignupWall}});var n,l,i=a(85893),r=a(11163),s=a(67294),o=a(22578),u=a(67894),d=a(6793),c=a(75704),g=a(19029),m=a(41019);let importSignupWallModal=()=>Promise.all([a.e(7648),a.e(2143),a.e(552)]).then(a.bind(a,69742));(n=l||(l={}))[n.navBarSignupButton=1]="navBarSignupButton",n[n.leftSidebarExploreButton=2]="leftSidebarExploreButton",n[n.leftSidebarCreateBotButton=3]="leftSidebarCreateBotButton",n[n.sendMessage=4]="sendMessage",n[n.poeLogo=5]="poeLogo",n[n.headerBarCreateChatButton=6]="headerBarCreateChatButton",n[n.voteAction=7]="voteAction",n[n.loggedOutUserExpiredModal=8]="loggedOutUserExpiredModal",n[n.retryMessage=9]="retryMessage";let f=[3,2,6,5],useSignupWall=()=>{let{setSignupWallVisible:e,shouldShowSignupWall:t,signupWallVisible:n,setTriggerSource:l,signupWallTriggerSource:i,setIsLoadingAfterSignupOrLogin:r}=s.useContext(p),d=(0,u.Z)(),c=(0,o.useRelayEnvironment)(),g=(0,s.useCallback)(t=>{if(e(!0),d){let e=!(t&&f.includes(t));(0,o.commitMutation)(c,{mutation:a(37480),variables:{chatCode:d,shouldReturnChatCodePostSignupLogin:e}})}t&&l(t)},[e,d,c,l]),m=(0,s.useCallback)(t=>{e(!1),t&&r(!0)},[e,r]);return{shouldShowSignupWall:t,signupWallVisible:n,openSignupWall:g,closeSignupWall:m,signupWallTriggerSource:i,setIsLoadingAfterSignupOrLogin:r}},p=s.createContext({setSignupWallVisible:()=>{},shouldShowSignupWall:!1,signupWallVisible:!1,setTriggerSource:()=>{},isLoadingAfterSignupOrLogin:!1,setIsLoadingAfterSignupOrLogin:()=>{}});t.ZP=e=>{let{viewer:t,children:n}=e,[l,u]=(0,s.useState)(!1),[f,h]=(0,s.useState)(!1),[k,y]=(0,s.useState)(),b=(0,r.useRouter)(),v=(0,s.useCallback)(()=>{(0,d.dh)(b),u(!1),(0,g.Z)("poe/signup_wall_closed",{current_url:b.asPath})},[u,b]),S=(0,o.useFragment)(a(72930),t),_=(0,s.useMemo)(()=>({viewer:S}),[S]),C=(0,s.useMemo)(()=>({shouldShowSignupWall:!S.uid,setSignupWallVisible:u,signupWallVisible:l,setTriggerSource:y,signupWallTriggerSource:k,isLoadingAfterSignupOrLogin:f,setIsLoadingAfterSignupOrLogin:h}),[S.uid,u,l,k,y,f,h]);return(0,i.jsx)(i.Fragment,{children:(0,i.jsx)(p.Provider,{value:C,children:f?(0,i.jsx)(c.Sz,{}):(0,i.jsxs)(i.Fragment,{children:[n,l&&(0,i.jsx)(m.Z,{isOpen:l,onRequestClose:v,body:importSignupWallModal,bodyProps:_})]})})})}},6793:function(e,t,a){"use strict";a.d(t,{Dl:function(){return redirectToLoginPageForSocialSignupAttemptMissingBirthday},Ho:function(){return redirectToLoginPageForSocialSignupAttemptMissingEmail},SN:function(){return setRedirectUrlQueryParamForCurrentUrl},Sh:function(){return useOnLoginSuccess},Tt:function(){return getLoginUrlForEmbedPage},X0:function(){return redirectToLoginPage},b8:function(){return redirectToLoggedInHomePage},bU:function(){return k},bl:function(){return i},dh:function(){return removeRedirectUrlQueryParamFromCurrentUrl},gA:function(){return getRedirectUrlFromSignupLoginResponse},gS:function(){return getDefaultUserVerificationErrorMessage},gW:function(){return getDesktopAppOpenPageUrl},n$:function(){return r},o1:function(){return maybeGetRedirectUrl},q2:function(){return y},qN:function(){return redirectToLoginPageForAppleSignupObfuscatedEmail},yn:function(){return getDefaultLoginErrorMessage}});var n,l,i,r,s=a(11163),o=a(67294),u=a(22120),d=a(23491),c=a(2197),g=a(90289),m=a(66795),f=a(46857),p=a(75408),h=a(50530);let getDefaultUserVerificationErrorMessage=e=>e("Something went wrong. Please wait a moment and try again."),getDefaultLoginErrorMessage=e=>e("An error occurred, please try again."),k="redirect_url",redirectToLoginPageForAppleSignupObfuscatedEmail=(e,t)=>{redirectToLoginPage(e,t,{apple_optional_email:"1"})},redirectToLoginPageForSocialSignupAttemptMissingBirthday=(e,t,a)=>{redirectToLoginPage(e,a,{missing_birthday:"1",signup_method:t})},redirectToLoginPageForSocialSignupAttemptMissingEmail=(e,t)=>{redirectToLoginPage(e,t,{missing_email:"1"})},redirectToLoginPage=function(e,t){let a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return e.replace({pathname:"/login",query:{...a,[k]:null!=t?t:"/"}})},redirectToDesktopAppOpenPage=(e,t)=>{let a=getDesktopAppOpenPageUrl(t);e.replace(a)},maybeGetDesktopAppLoginRequestCode=e=>{let t=e.query.desktop_app_login_request_code;if((0,h.HD)(t)&&t.length>0)return t},setRedirectUrlQueryParamForCurrentUrl=(e,t)=>{e.replace({query:{...e.query,[k]:t}})},removeRedirectUrlQueryParamFromCurrentUrl=e=>{let t={...e.query};delete t[k],e.replace({query:t})},getLoginUrlForEmbedPage=()=>"/login?".concat(k,"=").concat(encodeURIComponent("/close_window")),getDesktopAppOpenPageUrl=e=>"/desktop_app_open?desktop_app_login_request_code=".concat(encodeURIComponent(e)),redirectToLoggedInHomePage=function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];e.replace(t?"/?".concat("login_success","=1"):"/")},maybeGetRedirectUrl=e=>{let t=e.query[k];if((0,h.HD)(t)&&t.length>0)return t},getRedirectUrlFromSignupLoginResponse=e=>{let{redirectChatCode:t,redirectUrl:a}=e;if(t)return"/chat/".concat(t);if(a){let e=a.split("?")[1];if(e){let t=new URLSearchParams(e).get(k);if(t)return t}}return null!=a?a:void 0},useOnLoginSuccess=()=>{let{t:e}=(0,u.$G)(),t=(0,s.useRouter)(),a=(0,p.AO)(),n=(0,c.ZP)(),{setShowIntro:l}=(0,d.CK)(),i=(0,m.q)(),r=(0,o.useCallback)(t=>n({content:t?e("You have successfully signed up"):e("You have successfully logged in"),type:c.pC.success}),[n,e]);return(0,o.useCallback)(async e=>{let{isSignUp:n,isEligibleForRedirectToLoggedInHomePage:s=!0,showLoginSuccessToastAfterRedirectingToHomePage:o=!1,redirectUrl:u=maybeGetRedirectUrl(t),loginRequestCode:d=maybeGetDesktopAppLoginRequestCode(t)}=e;if(n?(await (0,f.hP)("sng_complete_registration"),l(!0)):await (0,f.hP)("sng_login"),d){r(!1),redirectToDesktopAppOpenPage(t,d);return}u?(u===t.asPath&&r(n),await t.replace(u)):s?redirectToLoggedInHomePage(t,o):r(n),i(),(0,g.E)(),a(!0)},[t,a,l,i,r])};(n=i||(i={}))[n.loginStarted=0]="loginStarted",n[n.signupStarted=1]="signupStarted",n[n.signupContinued=2]="signupContinued",n[n.signupContinuedCodeSent=3]="signupContinuedCodeSent",n[n.signupContinuedBirthdayRequired=4]="signupContinuedBirthdayRequired",(l=r||(r={}))[l.emailAddress=0]="emailAddress",l[l.phoneNumber=1]="phoneNumber";let y=/^[0-9]{6,}$/i},69295:function(e,t,a){"use strict";a.d(t,{Bb:function(){return p},DF:function(){return c},F_:function(){return h},PL:function(){return g},Xd:function(){return d},oM:function(){return m},t9:function(){return f}});var n=a(85893),l=a(41664),i=a.n(l),r=a(67294),s=a(34616),o=a(10864),u=a.n(o);let d=(0,r.forwardRef)((e,t)=>{let{variant:a="secondary",href:l,target:o,className:d,icon:c,children:g,onClick:m,...f}=e,p=!r.Children.toArray(g).length;return l?(0,n.jsxs)(i(),{href:l,target:o,className:(0,s.$)(u().buttonBase,u()[a],d,p&&u().iconOnly),onClick:m,ref:t,children:[c,g]}):(0,n.jsxs)("button",{...f,className:(0,s.$)(u().buttonBase,u()[a],d,p&&u().iconOnly),onClick:m,ref:t,children:[c,g]})});d.displayName="ButtonBase";let c=(0,r.forwardRef)((e,t)=>{let{...a}=e;return(0,n.jsx)(d,{...a,ref:t,variant:"primary"})});c.displayName="ButtonPrimary";let g=(0,r.forwardRef)((e,t)=>{let{...a}=e;return(0,n.jsx)(d,{...a,ref:t,variant:"secondary"})});g.displayName="ButtonSecondary";let m=(0,r.forwardRef)((e,t)=>{let{...a}=e;return(0,n.jsx)(d,{...a,ref:t,variant:"tertiary"})});m.displayName="ButtonTertiary";let f=(0,r.forwardRef)((e,t)=>{let{...a}=e;return(0,n.jsx)(d,{...a,ref:t,variant:"flat"})});f.displayName="ButtonFlat";let p=(0,r.forwardRef)((e,t)=>{let{...a}=e;return(0,n.jsx)(d,{...a,ref:t,variant:"danger"})});p.displayName="ButtonDanger";let h=(0,r.forwardRef)((e,t)=>{let{...a}=e;return(0,n.jsx)(d,{...a,ref:t,variant:"chatShare"})});h.displayName="ButtonShareChat"},41019:function(e,t,a){"use strict";var n=a(85893),l=a(67294),i=a(83253),r=a.n(i),s=a(39620),o=a(34616),u=a(57138),d=a(50530),c=a(82686),g=a.n(c),m=a(69295),f=a(34950),p=a(75704),h=a(30791);let parentSelector=()=>document.body;r().setAppElement("#__next");let k={height:200},ModalLoadingState=e=>{let{modalStyles:t}=e,[a,i]=(0,l.useState)(!1);return(0,l.useEffect)(()=>{let e=window.setTimeout(()=>{i(!0)},200);return()=>{window.clearTimeout(e)}},[]),(0,n.jsx)("article",{style:t||k,children:a&&(0,n.jsx)(p.Sz,{})})},modalErrorFallback=e=>{let{error:t}=e;return(0,n.jsx)(ModalErrorState,{error:t})},ModalErrorState=e=>{let{error:t}=e,a=(0,u.Ej)(t);return(0,n.jsxs)("article",{className:g().errorState,children:["statusCode"in t&&(0,d.hj)(t.statusCode)&&(0,n.jsx)("h1",{children:t.statusCode}),(0,n.jsx)("p",{children:a})]})};t.Z=e=>{let{isOpen:t,onRequestClose:a,body:i,bodyProps:u,modalHeight:d,useMinHeight:c=!1,useIncreasedHeightInCompactScreen:p=!1,actions:k,headerActions:y,customHeaderStyle:b,customButtonStyle:v,shouldCloseOnOverlayClick:S=!0,variant:_="regular",showCloseButton:C=!0}=e,L=(0,l.useMemo)(()=>void 0===d?void 0:c?{minHeight:d}:{height:d},[d,c]),F=(0,l.useMemo)(()=>(0,l.lazy)(i),[i]),M=(0,l.useRef)(null);return(0,n.jsxs)(r(),{isOpen:t,onRequestClose:a,parentSelector:parentSelector,shouldCloseOnOverlayClick:S,shouldReturnFocusAfterClose:!0,overlayClassName:g().overlay,className:(0,o.$)(g().modal,"compact"===_&&g().modalCompact,p&&g().modalIncreasedHeight),children:[(0,n.jsxs)("div",{className:(0,o.$)(g().header,b),children:[C&&(0,n.jsx)(m.t9,{className:(0,o.$)(g().closeButton,g().closeFlatButton,v),onClick:a,"aria-label":"close modal",children:(0,n.jsx)(s.Z,{})}),k&&(0,n.jsx)("div",{className:g().actionsWrapper,children:k}),y&&(0,n.jsx)("div",{className:g().headerActionsWrapper,children:y})]}),(0,n.jsx)("article",{ref:M,style:L,className:g().modalBody,children:(0,n.jsx)(h.f.Provider,{value:M,children:(0,n.jsx)(f.Z,{fallback:modalErrorFallback,children:(0,n.jsx)(l.Suspense,{fallback:(0,n.jsx)(ModalLoadingState,{modalStyles:L}),children:(0,n.jsx)(F,{...u})})})})}),k&&(0,n.jsx)("div",{className:g().footer,children:(0,n.jsx)("div",{className:g().actionsWrapper,children:k})})]})}},30791:function(e,t,a){"use strict";a.d(t,{f:function(){return l}});var n=a(67294);let l=(0,n.createContext)(null)},37650:function(e,t,a){"use strict";a.d(t,{A7:function(){return moveBotToTopAfterDefaultBot},As:function(){return moveBotToTop},FL:function(){return useIsSDXL},Fo:function(){return addBotToTop},Rq:function(){return r},iZ:function(){return useDeletion},lR:function(){return useViewerHasNoMessagesLeft},nn:function(){return useViewerCanAccessPrivateBot},rY:function(){return moveBotToTopAfterSystemBots},vu:function(){return moveBotToBottom}});var n=a(22578),l=a(44311),i=a(32914);let moveBotToTop=(e,t)=>{let a=e.getRoot().getLinkedRecord("viewer");if(!a)return;let n=a.getLinkedRecords("availableBots");if(!n)return;let l=n.findIndex(e=>e.getDataID()===t);if(-1===l||l<6)return;let i=[...n.slice(0,5),n[l],...n.slice(5,l),...n.slice(l+1)];a.setLinkedRecords(i,"availableBots")},moveBotToTopAfterSystemBots=(e,t)=>{var a;let n;let i=e.getRoot().getLinkedRecord("viewer");if(!i)return;let r=l.ConnectionHandler.getConnection(i,"HomeBotSelector_viewer_availableBotsConnection");if(!r)return;let s=r.getLinkedRecords("edges");if(!s||s.length<=6)return;let o=s.findIndex(e=>{var a;return(null===(a=e.getLinkedRecord("node"))||void 0===a?void 0:a.getValue("id"))===t});if(-1!==o&&o<=5)return;if(-1===o){let a=e.get(t);if(!a)return;n=l.ConnectionHandler.createEdge(e,r,a,"BotEdge")}else n=s[o],l.ConnectionHandler.deleteNode(r,t);let u=null===(a=s[5])||void 0===a?void 0:a.getValue("cursor");l.ConnectionHandler.insertEdgeAfter(r,n,u)},moveBotToTopAfterDefaultBot=(e,t)=>{var a;let n;let i=e.getRoot().getLinkedRecord("viewer");if(!i)return;let r=l.ConnectionHandler.getConnection(i,"HomeBotSelector_viewer_availableBotsConnection");if(!r)return;let s=r.getLinkedRecords("edges");if(!s)return;let o=s.findIndex(e=>{var a;return(null===(a=e.getLinkedRecord("node"))||void 0===a?void 0:a.getValue("id"))===t});if(0===o)return;if(-1===o){let a=e.get(t);if(!a)return;n=l.ConnectionHandler.createEdge(e,r,a,"BotEdge")}else n=s[o],l.ConnectionHandler.deleteNode(r,t);let u=null===(a=s[0])||void 0===a?void 0:a.getValue("cursor");l.ConnectionHandler.insertEdgeAfter(r,n,u)},moveBotToBottom=(e,t)=>{let a=e.getRoot().getLinkedRecord("viewer");if(!a)return;let n=a.getLinkedRecords("availableBots");if(!n)return;let l=n.findIndex(e=>e.getDataID()===t);if(-1===l||l<5)return;let i=[...n.slice(0,l),...n.slice(l+1),n[l]];a.setLinkedRecords(i,"availableBots")},addBotToTop=(e,t)=>{let a=e.get(t);if(!a)return;let n=e.getRoot().getLinkedRecord("viewer");if(!n)return;let l=n.getLinkedRecords("availableBots");if(!l)return;let i=l.findIndex(e=>e.getDataID()===t);if(-1!==i)return moveBotToTop(e,t);let r=[...l.slice(0,5),a,...l.slice(5)];n.setLinkedRecords(r,"availableBots")},useViewerCanAccessPrivateBot=e=>{let t=(0,n.useFragment)(a(34905),e);return t.canUserAccessBot},useDeletion=e=>{let{deletionState:t}=(0,n.useFragment)(a(42838),e);return{isDeleted:t!==i.Z.not_deleted,isForceDeleted:t!==i.Z.not_deleted&&t!==i.Z.user_deleted,isHardDeleted:t===i.Z.hard_deleted,deletionState:t}},useViewerHasNoMessagesLeft=e=>{let t=(0,n.useFragment)(a(38764),e),l=!t.messageUsageLimit.canSendMessage;return l},r=1579852,useIsSDXL=e=>{let t=(0,n.useFragment)(a(82071),e);if(!t)return!1;let{baseBotId:l,botId:i}=t;return l===r||i===r}},71289:function(e,t,a){"use strict";a.d(t,{$3:function(){return useSendMessage},OE:function(){return isBotMessage},Q1:function(){return isHumanMessage},Tt:function(){return l},Ue:function(){return _},cq:function(){return C},gR:function(){return moveChatToTop},hb:function(){return isChatBreak},i4:function(){return useTimeoutLevel},wz:function(){return useStopMessageAndSendChatBreak},yP:function(){return useStopMessage}});var n,l,i=a(41143),r=a.n(i),s=a(67294),o=a(22578),u=a(18093),d=a(2197),c=a(36025),g=a(19029),m=a(10406),f=a(90578),p=a(89083),h=a(47875),k=a(8611),y=a(37650),b=a(80393),v=a(53533),S=a(46857);let _="ChatMessagesView_chat_messagesConnection",C=(0,s.createContext)({isEmbed:!1}),genRandomId=()=>Math.floor(1e9*Math.random());(n=l||(l={})).human="human",n.chatBreak="chat_break",n.pacarana="pacarana";let isBotMessage=e=>{if(!e)return!1;let t=(0,o.readInlineData)(a(45981),e);return!isHumanMessage(t)&&!isChatBreak(t)},isHumanMessage=e=>{if(!e)return!1;let t=(0,o.readInlineData)(a(71349),e);return"human"===t.author},isChatBreak=e=>{if(!e)return!1;let t=(0,o.readInlineData)(a(33740),e);return"chat_break"===t.author},useTimeoutLevel=(e,t,n,l,i)=>{var u;let d=(0,o.useFragment)(a(41360),e),c=(0,o.useFragment)(a(8875),t),p=(0,o.useFragment)(a(445),n),h=(0,o.useFragment)(a(85477),l),y=(0,o.useFragment)(a(38324),i),b=(0,o.useRelayEnvironment)();return(0,s.useEffect)(()=>{var e;if(d.isOptimistic&&"human"===d.author&&(null!==(e=d.timeoutLevel)&&void 0!==e?e:0)<3){let e=window.setTimeout(()=>{(0,o.commitLocalUpdate)(b,e=>{var t;let a=e.get(d.id);r()(a,"node is ".concat(a));let n=null!==(t=a.getValue("timeoutLevel"))&&void 0!==t?t:0,l=n+1;a.setValue(l,"timeoutLevel"),3===l&&a.setValue(k.Z.error,"state")})},5e3);return()=>{window.clearTimeout(e)}}},[d,b]),(0,s.useEffect)(()=>{var e;let t=Math.floor(p.messageTimeoutSecs/5);if(d.state===k.Z.incomplete&&(!d.isOptimistic||"human"!==d.author)&&(null!==(e=d.timeoutLevel)&&void 0!==e?e:0)<t){let e=window.setTimeout(()=>{(0,o.commitLocalUpdate)(b,e=>{var a,n,l,i,s,o;let u=e.get(d.id);r()(u,"node is ".concat(u));let b=null!==(o=u.getValue("timeoutLevel"))&&void 0!==o?o:0,S=b+1;u.setValue(S,"timeoutLevel"),(0,f.ZR)();let _={message_id:d.messageId,platform:"web",bot_id:p.botId,chat_id:c.chatId,default_bot_nickname:p.nickname,user_agent:window.navigator.userAgent,paired_message_id:null==y?void 0:y.messageId,uid:h.uid,isCurrentlyOnline:window.navigator.onLine,hasBeenOffline:(0,m.q)(),timeSinceOrigin:window.performance.now(),connection:{downlink:null===(a=window.navigator.connection)||void 0===a?void 0:a.downlink,effectiveType:null===(n=window.navigator.connection)||void 0===n?void 0:n.effectiveType,rtt:null===(l=window.navigator.connection)||void 0===l?void 0:l.rtt,saveData:null===(i=window.navigator.connection)||void 0===i?void 0:i.saveData,type:null===(s=window.navigator.connection)||void 0===s?void 0:s.type},messageLength:d.text.length};S===t?(u.setValue(k.Z.error,"state"),(0,g.Z)("poe/statsd_event",{key:"poe.message.timeout",value:1,category:"count",extra_data:_}),(0,v.ZP)().then(e=>{var t,a;if(null===(t=e.tchannelData)||void 0===t?void 0:t.channel){let t=null===(a=e.tchannelData)||void 0===a?void 0:a.channel.split("-")[1];(0,g.Z)("poe/statsd_event",{key:"poe.message.timeout_channel.".concat(t),value:1,category:"count",extra_data:_})}})):(0,g.Z)("poe/statsd_event",{key:"poe.message.timeout_level.".concat(S),value:1,category:"count",extra_data:_})})},5e3);return()=>{window.clearTimeout(e)}}},[d,b,c,p,y,h]),null!==(u=d.timeoutLevel)&&void 0!==u?u:0},L="ChatMessageInputView_OptimisticHumanMessage",F="ChatMessageInputView_OptimisticChatBreakEdge",M="ChatMessageInputView_OptimisticChatBreak",w="ChatMessageInputView_OptimisticIntroductionMessage",useSendMessage=function(e,t,n){let l=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=(0,o.useFragment)(a(36462),e),g=(0,o.useFragment)(a(79390),t),[m]=(0,o.useMutation)(a(11701)),v=(0,o.useRelayEnvironment)(),{resetLoggedOutTimeout:C}=(0,u.v)(),w=(0,s.useCallback)(e=>{let t=e.get(i.id);r()(t,"chatRecord is ".concat(t));let a=o.ConnectionHandler.getConnection(t,_);r()(a,"connectionRecord is ".concat(a));let n=e.getRootField("messageEdgeCreate");r()(n,"payload is ".concat(n)),moveChatToTop(e,i.id),(0,y.rY)(e,g.id);let l=n.getLinkedRecord("chatBreak"),s=n.getLinkedRecord("message"),u=null==s?void 0:s.getLinkedRecord("node"),d=null==u?void 0:u.getValue("clientNonce");if(l){let t=o.ConnectionHandler.buildConnectionEdge(e,a,l);r()(t,"newChatBreakEdge is ".concat(t)),o.ConnectionHandler.insertEdgeAfter(a,t)}if(d){let e=a.getLinkedRecords("edges");if(e&&e.some(e=>{var t;return(null===(t=e.getLinkedRecord("node"))||void 0===t?void 0:t.getValue("clientNonce"))===d}))return}let c=o.ConnectionHandler.buildConnectionEdge(e,a,s);c&&(r()(c,"newMessageEdge is ".concat(c)),o.ConnectionHandler.insertEdgeAfter(a,c))},[i,g]),B=(0,d.ZP)(),x=(0,s.useCallback)(async e=>{let{prompt:t,files:a,source:s}=e;(0,f.Si)();let u=(0,b.z)(16),y=await (0,S.h0)(),x=a?Array.from(a).reduce((e,t,a)=>({...e,["file".concat(a)]:t}),{}):void 0,E=a?a.map((e,t)=>({id:"".concat("ChatMessageInputView_OptimisticHumanMessageAttachment","_").concat(t),name:e.name,file:{id:"".concat("ChatMessageInputView_OptimisticHumanMessageAttachmentFile","_").concat(t),size:e.size,mimeType:e.type}})):[];m({variables:{chatId:i.chatId,bot:g.nickname,query:t,source:s||n,withChatBreak:l,clientNonce:u,sdid:y,attachments:x?Array.from(Object.keys(x)):void 0},optimisticResponse:{messageEdgeCreate:{chatBreak:l?{id:F,cursor:M,node:{id:M,messageId:M,text:"",author:"chat_break",isOptimistic:!0,suggestedReplies:[],creationTime:1e3*Date.now()-1,state:k.Z.complete,clientNonce:null}}:null,message:{id:"ChatMessageInputView_OptimisticHumanMessageEdge",cursor:L,node:{id:L,messageId:L,text:t,author:"human",isOptimistic:!0,suggestedReplies:[],creationTime:1e3*Date.now(),state:k.Z.complete,clientNonce:u,contentType:t.length>1e5?p.Z.text_plain:p.Z.text_markdown,attachments:E}},status:h.Z.success,failedUrls:[]}},updater:w,optimisticUpdater:w,onCompleted:e=>{var t;let a=e.messageEdgeCreate.status;if(a!==h.Z.success){B({type:d.pC.error,content:e.messageEdgeCreate.statusMessage});return}let n=getErrorMessageFromFailedUrls(e.messageEdgeCreate.failedUrls);n&&B({type:d.pC.error,content:n}),C();let l=null===(t=e.messageEdgeCreate.message)||void 0===t?void 0:t.node.messageId;r()(l,"messageId is ".concat(l)),(0,c.Ot)(L,l);let addOptimisticBotResponse=()=>setTimeout(()=>{(0,o.commitLocalUpdate)(v,e=>{let t=e.get(i.id);r()(t,"Chat Record is ".concat(t));let a=o.ConnectionHandler.getConnection(t,_);r()(a,"Chat Connection is ".concat(a));let n=a.getLinkedRecords("edges");r()(n,"Messages is ".concat(n));let l=n[n.length-1].getLinkedRecord("node");if(r()(l,"Last Message is ".concat(l)),l.getValue("isOptimistic")){addOptimisticBotResponse();return}if("human"!==l.getValue("author"))return;let s=genRandomId(),u=String(s),d=e.create(u,"Message"),c=l.getValue("creationTime");r()(c,"Last Creation Time is ".concat(c));let m=c+1e6;d.setValue(u,"id"),d.setValue(s,"messageId"),d.setValue("...","text"),d.setValue(m,"creationTime"),d.setValue(g.nickname,"author"),d.setValue(k.Z.incomplete,"state"),d.setValue([],"suggestedReplies"),d.setValue(!0,"isOptimistic"),d.setLinkedRecords([],"attachments"),d.setLinkedRecord(t,"chat");let f=o.ConnectionHandler.createEdge(e,a,d,"MessageEdge");o.ConnectionHandler.insertEdgeAfter(a,f)})},100);addOptimisticBotResponse()},onError:e=>{console.error(e),(0,o.commitLocalUpdate)(v,e=>{let a=e.get(i.id);r()(a,"Chat Record is ".concat(a));let n=o.ConnectionHandler.getConnection(a,_);r()(n,"Chat Connection is ".concat(n));let l=n.getLinkedRecords("edges");r()(l,"Messages is ".concat(l));let s=l[l.length-1].getLinkedRecord("node");r()(s,"Last Message is ".concat(s));let u=String(genRandomId()),d=e.create(u,"Message"),c=s.getValue("creationTime");r()(c,"Last Creation Time is ".concat(c));let g=c+1e6;d.setValue(u,"id"),d.setValue(genRandomId(),"messageId"),d.setValue(t,"text"),d.setValue(g,"creationTime"),d.setValue("human","author"),d.setValue(k.Z.error,"state"),d.setValue([],"suggestedReplies"),d.setLinkedRecords([],"attachments"),window.navigator.onLine||d.setValue(!0,"offlineError"),d.setLinkedRecord(a,"chat");let m=o.ConnectionHandler.createEdge(e,n,d,"MessageEdge");o.ConnectionHandler.insertEdgeAfter(n,m)})},uploadables:x}),(0,c.CE)(L,i.chatId)},[m,i,g,v,n,w,l,B,C]);return x},useStopMessageUpdater=e=>{var t;let{edges:n}=e,l=(0,o.useFragment)(a(87410),n),i=null===(t=l[l.length-1])||void 0===t?void 0:t.node,r=null==i?void 0:i.text,u=null==r?void 0:r.length,d=(0,s.useCallback)(e=>{if(!i)return;let t=e.get(i.id);t&&(t.setValue(u,"textLengthOnCancellationImmediate"),t.setValue(r,"text"))},[i,r,u]);return{updater:d,message:i}},useStopMessage=e=>{let{edges:t}=e,n=(0,o.useFragment)(a(90138),t),[l]=(0,o.useMutation)(a(30561)),{updater:i,message:r}=useStopMessageUpdater({edges:n}),u=(0,s.useCallback)(()=>{if(!r)return;let e=r.text.length;l({variables:{messageId:r.messageId,textLength:e},optimisticResponse:{messageCancel:{message:{id:r.id,state:k.Z.cancelled,text:r.text,textLengthOnCancellation:e}}},updater:i})},[l,i,r]);return u},useStopMessageAndSendChatBreak=e=>{let{edges:t,chat:n,bot:l}=e,i=(0,o.useFragment)(a(38730),n),r=(0,o.useFragment)(a(37584),l),u=(0,o.useFragment)(a(65964),t),[d]=(0,o.useMutation)(a(93107)),{updater:c,message:g}=useStopMessageUpdater({edges:u}),m=(0,s.useCallback)(()=>{var e;if(!g)return;let t=g.text.length,a=o.ConnectionHandler.getConnectionID(null!==(e=null==i?void 0:i.id)&&void 0!==e?e:"",_);d({variables:{connections:[a],messageId:g.messageId,textLength:t},optimisticResponse:{messageCancelAndBreakEdgeCreate:{message:{id:g.id,state:k.Z.cancelled,text:g.text,textLengthOnCancellation:t},messageBreakEdge:{id:F,cursor:M,node:{id:M,messageId:M,text:"",author:"chat_break",suggestedReplies:[],creationTime:1e3*Date.now(),state:k.Z.complete}},introductionMessageEdge:r.introduction?{id:"ChatMessageInputView_OptimisticIntroductionMessageEdge",cursor:w,node:{id:w,messageId:w,text:r.introduction,author:r.model,suggestedReplies:[],creationTime:1e3*Date.now(),state:k.Z.complete}}:null}},updater:c})},[i,r,d,g,c]);return m},getErrorMessageFromFailedUrls=e=>{if(0===e.length)return null;let t=e[0].reason;if(1===e.length)switch(t){case"fetch_error":return"Failed to fetch ".concat(e[0].url," because of a problem crawling the URL.");case"over_budget":return"Failed to fetch ".concat(e[0].url," because it was too large. Please keep crawled web pages to <100 MB total.");case"unsupported_content_type":return"Failed to fetch ".concat(e[0].url," because it was not a supported content type.");default:return"Failed to fetch ".concat(e[0].url,".")}switch(t){case"fetch_error":return"Failed to fetch ".concat(e.length," urls because of problems crawling them.");case"over_budget":return"Failed to fetch ".concat(e.length," urls because they were too large. Please keep crawled web pages to <100 MB total.");case"unsupported_content_type":return"Failed to fetch ".concat(e.length," urls because of unsupported content types.");default:return"Failed to fetch ".concat(e.length," urls.")}},moveChatToTop=(e,t)=>{let a=e.getRoot(),n=o.ConnectionHandler.getConnection(a,"ChatHistoryList_queryRoot_chats");if(!n)return;let l=n.getLinkedRecords("edges");if(!l)return;let i=l.find(e=>{var a;return(null===(a=e.getLinkedRecord("node"))||void 0===a?void 0:a.getValue("id"))===t});if(i)o.ConnectionHandler.deleteNode(n,t),o.ConnectionHandler.insertEdgeBefore(n,i);else{let a=e.get(t);if(!a)return;let l=o.ConnectionHandler.createEdge(e,n,a,"ChatEdge");o.ConnectionHandler.insertEdgeBefore(n,l)}}},10406:function(e,t,a){"use strict";a.d(t,{q:function(){return getHasBeenOffline}});var n=a(67294);let l=!1,getHasBeenOffline=()=>l;t.Z=()=>{let[e,t]=(0,n.useState)(!1);return(0,n.useEffect)(()=>{let setOffline=()=>{l=!0,t(!0)},setOnline=()=>{t(!1)};return window.addEventListener("offline",setOffline),window.addEventListener("online",setOnline),()=>{window.removeEventListener("offline",setOffline),window.removeEventListener("online",setOnline)}},[t]),e}},80393:function(e,t,a){"use strict";a.d(t,{_:function(){return generateApiKey},z:function(){return generateRandomString}});let generateRandomString=e=>{let t="",a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",n=0;for(;n<e;)t+=a.charAt(Math.floor(Math.random()*a.length)),n+=1;return t},generateApiKey=()=>generateRandomString(32)},46857:function(e,t,a){"use strict";let n;a.d(t,{Rz:function(){return useInitSingular},h0:function(){return getSingularDeviceId},hP:function(){return singularEvent}});var l=a(67294);let i="quora_b_46ba1291c98480d9dde6fed2b16c7cae__90053357",r="aff4cbc69cc3fee7a3b851fb6c40fed3",s="com.poe",initSingular=async()=>{await loadAndInitSingularSdk()},useInitSingular=()=>{(0,l.useEffect)(()=>{initSingular()},[])},loadAndInitSingularSdk=async()=>(n||(n=_loadAndInitSingularSdk()),await n),_loadAndInitSingularSdk=async()=>{let e=await a.e(8961).then(a.t.bind(a,58961,23)),{singularSdk:t,SingularConfig:n}=e;return await new Promise(e=>{if(t&&n&&i&&r&&s){let a=new n(i,r,s);a.withInitFinishedCallback(()=>e()),t.init(a)}}),e},singularEvent=async e=>{let t=await loadAndInitSingularSdk();return t.singularSdk.event(e)},getSingularDeviceId=async()=>{let e=await loadAndInitSingularSdk();return e.singularSdk.getSingularDeviceId()}},32914:function(e,t){"use strict";var a,n;(n=a||(a={})).not_deleted="not_deleted",n.user_deleted="user_deleted",n.poe_deleted="poe_deleted",n.llm_deleted="llm_deleted",n.hard_deleted="hard_deleted",t.Z=a},89083:function(e,t){"use strict";var a,n;(n=a||(a={})).text_markdown="text_markdown",n.text_plain="text_plain",t.Z=a},47875:function(e,t){"use strict";var a,n;(n=a||(a={})).success="success",n.no_access="no_access",n.too_many_tokens="too_many_tokens",n.reached_limit="reached_limit",n.bot_is_down="bot_is_down",n.exception="exception",n.rate_limit_exceeded="rate_limit_exceeded",n.unsupported_file_type="unsupported_file_type",n.file_too_large="file_too_large",n.file_not_accessible="file_not_accessible",t.Z=a},82686:function(e){e.exports={medium:"only screen and (min-width : 685px)","compact-only":"only screen and (max-width : 684px)",overlay:"Modal_overlay___PrHh",modal:"Modal_modal__I_dBM",modalIncreasedHeight:"Modal_modalIncreasedHeight__TbIpS",modalCompact:"Modal_modalCompact__BQhmu",modalBody:"Modal_modalBody__BX0qa",header:"Modal_header__9MUIZ",actionsWrapper:"Modal_actionsWrapper__FyX5h",headerActionsWrapper:"Modal_headerActionsWrapper__3JP4U",closeButton:"Modal_closeButton__GycnR",footer:"Modal_footer__R7iNP",errorState:"Modal_errorState__7CZ5n"}}}]);