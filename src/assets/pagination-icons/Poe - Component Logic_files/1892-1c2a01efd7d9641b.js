(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1892],{81132:function(e,a,n){"use strict";n.r(a);let t={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"ChatPageNavActionBar_bot",selections:[{alias:null,args:null,kind:"ScalarField",name:"isSystemBot",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"isPrivateBot",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"viewerIsFollower",storageKey:null},{args:null,kind:"FragmentSpread",name:"BotFollowStateButton_bot"},{args:null,kind:"FragmentSpread",name:"BotShareButton_bot"},{args:null,kind:"FragmentSpread",name:"botHelpers_useDeletion_bot"}],type:"Bot",abstractKey:null};t.hash="4b22e87f2b7eff2725617b32292bafb5",a.default=t},89915:function(e,a,n){"use strict";n.r(a);let t={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"ChatPageNavbar_bot",selections:[{args:null,kind:"FragmentSpread",name:"ChatPageNavActionBar_bot"},{alias:null,args:null,kind:"ScalarField",name:"isDown",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"isPrivateBot",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"botId",storageKey:null}],type:"Bot",abstractKey:null};t.hash="63d9207f5c71d252b2f63e7e4092eaa9",a.default=t},36035:function(e,a,n){"use strict";n.r(a);let t={argumentDefinitions:[{defaultValue:5,kind:"LocalArgument",name:"count"},{defaultValue:null,kind:"LocalArgument",name:"cursor"}],kind:"Fragment",metadata:{connection:[{count:"count",cursor:"cursor",direction:"backward",path:["messagesConnection"]}]},name:"ChatPageNavbar_chat",selections:[{alias:null,args:null,kind:"ScalarField",name:"chatId",storageKey:null},{alias:"messagesConnection",args:null,concreteType:"MessagesConnection",kind:"LinkedField",name:"__ChatMessagesView_chat_messagesConnection_connection",plural:!1,selections:[{alias:null,args:null,concreteType:"MessageEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:null,args:null,concreteType:"Message",kind:"LinkedField",name:"node",plural:!1,selections:[{kind:"InlineDataFragmentSpread",name:"chatHelpers_isChatBreak",selections:[{alias:null,args:null,kind:"ScalarField",name:"author",storageKey:null}],args:null,argumentDefinitions:[]},{alias:null,args:null,kind:"ScalarField",name:"messageId",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"cursor",storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"PageInfo",kind:"LinkedField",name:"pageInfo",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"hasPreviousPage",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"startCursor",storageKey:null}],storageKey:null}],storageKey:null}],type:"Chat",abstractKey:null};t.hash="d95625b647c95aaed7a7673070337736",a.default=t},92672:function(e,a,n){"use strict";n.r(a);let t={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"ChatPageNavbar_viewer",selections:[{alias:"useShareButtonRedesign",args:[{kind:"Literal",name:"gateName",value:"poe_share_button_redesign"}],kind:"ScalarField",name:"booleanGate",storageKey:'booleanGate(gateName:"poe_share_button_redesign")'},{alias:null,args:null,concreteType:"PoeUser",kind:"LinkedField",name:"poeUser",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null}],storageKey:null}],type:"Viewer",abstractKey:null};t.hash="b1adddd46d179ba3e536127bcc2c2a21",a.default=t},57890:function(e,a,n){"use strict";n.d(a,{Z:function(){return chat_ChatMainNavbar}});var t=n(85893),l=n(42116),r=n(67294),s=n(22120),i=n(22578),o=n(3108),u=n.n(o),bot_BotDownBanner=()=>{let{t:e}=(0,s.$G)();return(0,t.jsx)("div",{className:u().botDownBanner,children:e("This bot is currently down.")})},c=n(41019),d=n(3597),g=n(39620),h=n(61918),m=n(71289),_=n(6890),b=n(19029),f=n(50141),v=n(10406),p=n(57031),k=n.n(p),C=n(6488),x=n(44254),B=n(46296),S=n(35409),y=n(69295),F=n(96333),P=n.n(F),chat_ChatOfflineBanner=()=>{let{t:e}=(0,s.$G)();return(0,t.jsx)("div",{className:P().offlineBanner,children:e("You are offline.")})},N=n(37650),j=n(13827),w=n.n(j),I=n(83243),M=n(72211),chat_ChatPageNavActionBar=e=>{let{bot:a}=e,l=(0,i.useFragment)(n(81132),a),{isDeleted:r}=(0,N.iZ)(l);return l.isSystemBot||l.viewerIsFollower||r||l.isPrivateBot?null:(0,t.jsxs)("div",{className:w().container,children:[(0,t.jsx)(I.Z,{bot:l,variant:"flat"}),(0,t.jsx)(M.Z,{bot:l,variant:"flat"})]})};let importShareBotOrChatModal=()=>n.e(8289).then(n.bind(n,28289));var chat_ChatPageNavbar=e=>{let{bot:a,chat:l,viewer:o,children:u,toggleSidebarButton:p,useChatTitle:F=!1,hideActionBar:P=!1}=e,N=(0,i.useFragment)(n(89915),a),j=(0,i.useFragment)(n(36035),null!=l?l:null),w=(0,i.useFragment)(n(92672),o),I=(0,r.useContext)(m.cq),{shouldShowSignupWall:M,openSignupWall:K}=(0,S.zl)(),Z=!I.isEmbed,D=I.isEmbed,T=(0,_.av)(),V=(0,v.Z)(),{t:E}=(0,s.$G)(),[L,W]=(0,r.useState)(!1),{useShareButtonRedesign:A}=w,O=(0,r.useCallback)(()=>{W(!1)},[]),R=(0,r.useMemo)(()=>({botId:N.botId,chatId:null==j?void 0:j.chatId,closeModal:O}),[N,j,O]),z=(0,r.useMemo)(()=>{var e,a;return null==j?void 0:null===(a=j.messagesConnection)||void 0===a?void 0:null===(e=a.edges)||void 0===e?void 0:e.filter(e=>!(0,m.hb)(e.node)).map(e=>{var a;return null==e?void 0:null===(a=e.node)||void 0===a?void 0:a.messageId}).slice(-2)},[j]),{selectionMode:U,setSelectionMode:G,addSelection:X,clearSelection:H}=(0,f.ZP)(),$=(0,r.useCallback)(()=>{G(f.oW.none),H()},[G,H]),q=(0,r.useMemo)(()=>U===f.oW.none?p||(0,t.jsx)(B.Z,{}):(0,t.jsx)(y.t9,{className:k().endSelectionButton,onClick:$,children:(0,t.jsx)(g.Z,{className:k().closeIcon})}),[U,$,p]),Q=(0,r.useCallback)(()=>{A?W(!0):(z&&z.forEach(e=>X(e)),G(f.oW.share)),(0,b.Z)("poe/action_log",{action_type:C.Z.share_button_click,bot_id:N.botId,chat_id:null==j?void 0:j.chatId,action_metadata:{context:"nav_bar"}})},[G,X,z,A,N.botId,null==j?void 0:j.chatId]),Y=(0,r.useCallback)(e=>(0,t.jsx)(y.oM,{disabled:!A&&!(null==z?void 0:z.length),className:e?k().shareButton:k().noTextShareButton,onClick:Q,children:(0,t.jsxs)("span",{className:k().shareTextWrapper,children:[(0,t.jsx)(h.Z,{className:k().shareIcon}),e&&(0,t.jsx)("span",{className:k().shareText,children:E("Share")})]})}),[Q,E,z,A]),J=(0,r.useCallback)(()=>{M&&K(S.dh.navBarSignupButton)},[M,K]),ee=(0,r.useMemo)(()=>(0,t.jsx)(y.DF,{onClick:J,children:(0,t.jsx)("span",{className:k().signUpText,children:E("Sign up")})}),[J,E]),ea=(0,r.useMemo)(()=>{if(D)return(0,t.jsx)(d.Z,{});let e=!w.poeUser&&T;return(0,t.jsxs)("span",{className:k().rightNavItemWrapper,children:[U===f.oW.none&&!(null==N?void 0:N.isPrivateBot)&&Y(!e),e&&ee]})},[D,U,N,Y,w,ee,T]);return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(x.Z,{leftNavItem:Z&&q,rightNavItem:ea,useChatTitle:F,children:u}),!P&&(0,t.jsx)(chat_ChatPageNavActionBar,{bot:N}),V&&(0,t.jsx)(chat_ChatOfflineBanner,{}),N.isDown&&(0,t.jsx)(bot_BotDownBanner,{}),(0,t.jsx)(c.Z,{isOpen:L,onRequestClose:O,body:importShareBotOrChatModal,bodyProps:R,variant:"compact"})]})},chat_ChatMainNavbar=e=>(0,t.jsx)(chat_ChatPageNavbar,{toggleSidebarButton:(0,t.jsx)(l.Z,{}),hideActionBar:!0,...e})},16392:function(e,a,n){"use strict";var t=n(85893),l=n(67294),r=n(34616),s=n(13333),i=n.n(s),o=n(30791);let usePagingTriggerRef=e=>{let{loadMore:a,canLoadMore:n,rootMargin:t,scrollRootRef:r}=e,s=l.useRef(null),i=(0,l.useContext)(o.f),u=void 0!==r?r:i;return(0,l.useEffect)(()=>{var e;if(!s.current||!n)return;let l=new IntersectionObserver(e=>{e[0].isIntersecting&&a()},{root:null!==(e=null==u?void 0:u.current)&&void 0!==e?e:null,threshold:0,rootMargin:t});return l.observe(s.current),()=>{l.disconnect()}},[a,n,t,u]),s},calcRootMargin=(e,a,n)=>"".concat(!a&&n?e:0,"px ").concat(a&&!n?e:0,"px ")+"".concat(a||n?0:e,"px ").concat(a&&n?e:0,"px");a.Z=e=>{let{children:a,className:n,loadMore:l,hasMore:s,isLoading:o,loadingState:u=null,error:c,errorState:d=null,threshold:g,horizontal:h=!1,reverse:m=!1,scrollRootRef:_}=e,b=usePagingTriggerRef({loadMore:l,canLoadMore:s&&!o&&!c,rootMargin:calcRootMargin(g,h,m),scrollRootRef:_}),f=c?d:(0,t.jsx)("div",{ref:b,className:i().pagingTrigger,children:o&&u});return(0,t.jsxs)("div",{className:(0,r.$)(i().container,h&&i().horizontal,n),children:[m&&f,a,!m&&f]})}},50141:function(e,a,n){"use strict";n.d(a,{Br:function(){return MultiselectProvider},oW:function(){return l}});var t,l,r=n(85893),s=n(67294);(t=l||(l={}))[t.none=0]="none",t[t.share=1]="share",t[t.delete=2]="delete";let i=(0,s.createContext)(0),o=(0,s.createContext)(()=>{}),u=(0,s.createContext)([]),c=(0,s.createContext)(()=>{}),MultiselectProvider=e=>{let{children:a}=e,[n,t]=(0,s.useState)(0),[l,d]=(0,s.useState)([]);return(0,r.jsx)(i.Provider,{value:n,children:(0,r.jsx)(o.Provider,{value:t,children:(0,r.jsx)(u.Provider,{value:l,children:(0,r.jsx)(c.Provider,{value:d,children:a})})})})};a.ZP=()=>{let e=(0,s.useContext)(i),a=(0,s.useContext)(o),n=(0,s.useContext)(u),t=(0,s.useContext)(c),l=(0,s.useCallback)(e=>{t(a=>[...a,e])},[t]),r=(0,s.useCallback)(e=>{t(a=>a.filter(a=>a!==e))},[t]),d=(0,s.useCallback)(e=>{n.includes(e)?r(e):l(e)},[n,r,l]),g=(0,s.useCallback)(()=>{t([])},[t]),h=(0,s.useMemo)(()=>0!==e,[e]);return{selectionMode:e,selectedIds:n,setSelectionMode:a,addSelection:l,removeSelection:r,toggleSelection:d,clearSelection:g,isSelecting:h}}},3108:function(e){e.exports={botDownBanner:"BotDownBanner_botDownBanner__gn4_i"}},95427:function(e){e.exports={emptyView:"ChatMessagesView_emptyView__HqDf7",infiniteScroll:"ChatMessagesView_infiniteScroll__vk3VX",messagePair:"ChatMessagesView_messagePair__ZEXUz",loaderWrapper:"ChatMessagesView_loaderWrapper__XPhVQ",errorState:"ChatMessagesView_errorState__xXPE4"}},96333:function(e){e.exports={offlineBanner:"ChatOfflineBanner_offlineBanner__KOexN"}},13827:function(e){e.exports={container:"ChatPageNavActionBar_container__PVN0U"}},13333:function(e){e.exports={container:"InfiniteScroll_container__PHsd4",horizontal:"InfiniteScroll_horizontal__i7SXE",pagingTrigger:"InfiniteScroll_pagingTrigger__cdz9I"}}}]);